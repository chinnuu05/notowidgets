{"version":3,"file":"notosdk.js","sources":["../src/notosdk.ts"],"sourcesContent":["import { NotofoxConfig } from \"./lib/model\";\n\n// Notofox SDK class and initialization script\n(function(window: any, document: any) {\n    class Notofox {\n        private static instance: Notofox;\n        private queue: Array<[string, NotofoxConfig]> = [];\n        \n        private constructor() {\n            // Private constructor to enforce singleton\n        }\n\n        public static getInstance(): Notofox {\n            if (!Notofox.instance) {\n                Notofox.instance = new Notofox();\n            }\n            return Notofox.instance;\n        }\n\n        private initializeSDK(src: string): void {\n            console.log(\"[+] Initializing Notofox SDK\");\n            \n            // Load React and ReactDOM first\n            const reactScript = document.createElement('script');\n            reactScript.src = 'https://unpkg.com/react@18/umd/react.production.min.js';\n            reactScript.type = 'text/javascript';\n            \n            const reactDomScript = document.createElement('script');\n            reactDomScript.src = 'https://unpkg.com/react-dom@18/umd/react-dom.production.min.js';\n            reactDomScript.type = 'text/javascript';\n            \n            // Main widget script\n            const widgetScript = document.createElement('script');\n            widgetScript.src = src;\n            widgetScript.async = true;\n            widgetScript.type = 'text/javascript';\n            widgetScript.id = 'notofox-sdk';\n            \n            widgetScript.onload = () => {\n                console.log(\"[+] Widget script loaded from: \" + src);\n                this.initWidget();\n            };\n            \n            widgetScript.onerror = () => {\n                console.error('Failed to load widget bundle from: ' + src);\n            };\n            \n            // Chain the loading sequence\n            reactScript.onload = () => {\n                console.log(\"[+] React loaded\");\n                document.head.appendChild(reactDomScript);\n            };\n            \n            reactDomScript.onload = () => {\n                console.log(\"[+] ReactDOM loaded\");\n                document.head.appendChild(widgetScript);\n            };\n            \n            // Start the loading sequence\n            document.head.appendChild(reactScript);\n        }\n\n        private initWidget(): void {\n\n            if (window.NotofoxWidget) {\n                window.NotofoxWidget.init({\n                    project: 'test-project',\n                    defaultTheme: 'light',\n                    locale: 'en',\n                    containerId: 'notofox-widget',\n                });\n            }\n\n            else {\n                console.log(\"window.NotofoxWidget is not defined\");\n            }\n        }\n\n        private processQueue(): void {\n            while (this.queue.length > 0) {\n                const [action, config] = this.queue.shift()!;\n                if (action === 'initialize_widget' && window.NotofoxWidget) {\n                    console.log(\"[+] Initializing widget with config:\", config);\n                    window.NotofoxWidget.init(config);\n                }\n            }\n        }\n\n        public push(action: string, config: NotofoxConfig): void {\n            this.queue.push([action, config]);\n            \n            if (!document.getElementById('notofox-sdk')) {\n                console.log(\"Initializing TestWidget widget...\");\n                const widgetBundleUrl = \"../scripts/TestWidget.umd.js\";\n                this.initializeSDK(widgetBundleUrl);\n            } else if (window.NotofoxWidget) {\n                console.log(\"[+] Widget already initialized, processing queue...\");\n                this.processQueue();\n            }\n        }\n    }\n\n    // Initialize the global Notofox function\n    if (typeof window.Notofox !== 'function') {\n        window.Notofox = function(action: string, config: NotofoxConfig) {\n            const instance = Notofox.getInstance();\n            instance.push(action, config);\n        };\n    }\n\n})(window, document);"],"names":["window","document","_Notofox","__publicField","src","reactScript","reactDomScript","widgetScript","action","config","Notofox"],"mappings":"8LAGC,SAASA,EAAaC,EAAe,CAClC,MAAMC,EAAN,MAAMA,CAAQ,CAIF,aAAc,CAFdC,EAAA,aAAwC,CAAC,EAE3B,CAItB,OAAc,aAAuB,CAC7B,OAACD,EAAQ,WACDA,EAAA,SAAW,IAAIA,GAEpBA,EAAQ,QAAA,CAGX,cAAcE,EAAmB,CACrC,QAAQ,IAAI,8BAA8B,EAGpC,MAAAC,EAAcJ,EAAS,cAAc,QAAQ,EACnDI,EAAY,IAAM,yDAClBA,EAAY,KAAO,kBAEb,MAAAC,EAAiBL,EAAS,cAAc,QAAQ,EACtDK,EAAe,IAAM,iEACrBA,EAAe,KAAO,kBAGhB,MAAAC,EAAeN,EAAS,cAAc,QAAQ,EACpDM,EAAa,IAAMH,EACnBG,EAAa,MAAQ,GACrBA,EAAa,KAAO,kBACpBA,EAAa,GAAK,cAElBA,EAAa,OAAS,IAAM,CAChB,QAAA,IAAI,kCAAoCH,CAAG,EACnD,KAAK,WAAW,CACpB,EAEAG,EAAa,QAAU,IAAM,CACjB,QAAA,MAAM,sCAAwCH,CAAG,CAC7D,EAGAC,EAAY,OAAS,IAAM,CACvB,QAAQ,IAAI,kBAAkB,EAC9BJ,EAAS,KAAK,YAAYK,CAAc,CAC5C,EAEAA,EAAe,OAAS,IAAM,CAC1B,QAAQ,IAAI,qBAAqB,EACjCL,EAAS,KAAK,YAAYM,CAAY,CAC1C,EAGAN,EAAS,KAAK,YAAYI,CAAW,CAAA,CAGjC,YAAmB,CAEnBL,EAAO,cACPA,EAAO,cAAc,KAAK,CACtB,QAAS,eACT,aAAc,QACd,OAAQ,KACR,YAAa,gBAAA,CAChB,EAID,QAAQ,IAAI,qCAAqC,CACrD,CAGI,cAAqB,CAClB,KAAA,KAAK,MAAM,OAAS,GAAG,CAC1B,KAAM,CAACQ,EAAQC,CAAM,EAAI,KAAK,MAAM,MAAM,EACtCD,IAAW,qBAAuBR,EAAO,gBACjC,QAAA,IAAI,uCAAwCS,CAAM,EAC1DT,EAAO,cAAc,KAAKS,CAAM,EACpC,CACJ,CAGG,KAAKD,EAAgBC,EAA6B,CACrD,KAAK,MAAM,KAAK,CAACD,EAAQC,CAAM,CAAC,EAE3BR,EAAS,eAAe,aAAa,EAI/BD,EAAO,gBACd,QAAQ,IAAI,qDAAqD,EACjE,KAAK,aAAa,IALlB,QAAQ,IAAI,mCAAmC,EAE/C,KAAK,cADmB,8BACU,EAItC,CACJ,EA9FAG,EADED,EACa,YADnB,IAAMQ,EAANR,EAmGI,OAAOF,EAAO,SAAY,aAC1BA,EAAO,QAAU,SAASQ,EAAgBC,EAAuB,CAC5CC,EAAQ,YAAY,EAC5B,KAAKF,EAAQC,CAAM,CAChC,EAGR,GAAG,OAAQ,QAAQ"}