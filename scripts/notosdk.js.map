{"version":3,"file":"notosdk.js","sources":["../src/notosdk.ts"],"sourcesContent":["import { NotofoxConfig } from \"./lib/model\";\n\n(function (window: any, document: any) {\n  class Notofox {\n    // Points to your self-contained UMD that has React built in\n    private widgetSrc: string =\n      \"https://raw.githack.com/chinnuu05/notowidgets/master/TestWidgetV10.js\";\n\n    constructor() {\n      console.log(\"[+] Notofox SDK initialized.\");\n    }\n\n    public initialize(config: NotofoxConfig): void {\n      console.log(\"[+] Initializing widget with config:\", config);\n      this.loadWidgetScript(config);\n    }\n\n    private loadWidgetScript(config: NotofoxConfig): void {\n      console.log(`[+] Loading widget script: ${this.widgetSrc}`);\n      this.loadScript(this.widgetSrc, () => {\n        console.log(\"[+] Widget script loaded.\");\n        // Wait for the global to appear\n        this.waitForWidget(() => {\n          console.log(\"[+] NotofoxWidget available, calling init()\");\n          window.NotofoxWidget.init(config);\n        });\n      });\n    }\n\n    private loadScript(src: string, callback: () => void): void {\n      if (document.querySelector(`script[src=\"${src}\"]`)) {\n        console.log(`[!] Script ${src} already loaded.`);\n        callback();\n        return;\n      }\n      const script = document.createElement(\"script\");\n      script.src = src;\n      script.async = true;\n      script.type = \"text/javascript\";\n      script.onload = callback;\n      script.onerror = () => console.error(`[X] Failed to load script: ${src}`);\n      document.head.appendChild(script);\n    }\n\n    private waitForWidget(callback: () => void, retries = 50, interval = 100): void {\n      if (window.NotofoxWidget) {\n        callback();\n      } else if (retries > 0) {\n        console.log(`[!] Waiting for NotofoxWidget... Retries left: ${retries}`);\n        setTimeout(() => this.waitForWidget(callback, retries - 1, interval), interval);\n      } else {\n        console.error(\"[X] NotofoxWidget did not load in time.\");\n      }\n    }\n  }\n\n  window.Notofox = function (action: string, config: NotofoxConfig) {\n    if (action === \"initialize_widget\") {\n      new Notofox().initialize(config);\n    } else {\n      console.error(`[X] Unknown action: ${action}`);\n    }\n  };\n})(window, document);\n"],"names":["window","document","Notofox","__publicField","config","src","callback","script","retries","interval","action"],"mappings":"8LAEC,SAAUA,EAAaC,EAAe,CACrC,MAAMC,CAAQ,CAKZ,aAAc,CAHNC,EAAA,iBACN,yEAGA,QAAQ,IAAI,8BAA8B,CAAA,CAGrC,WAAWC,EAA6B,CACrC,QAAA,IAAI,uCAAwCA,CAAM,EAC1D,KAAK,iBAAiBA,CAAM,CAAA,CAGtB,iBAAiBA,EAA6B,CACpD,QAAQ,IAAI,8BAA8B,KAAK,SAAS,EAAE,EACrD,KAAA,WAAW,KAAK,UAAW,IAAM,CACpC,QAAQ,IAAI,2BAA2B,EAEvC,KAAK,cAAc,IAAM,CACvB,QAAQ,IAAI,6CAA6C,EACzDJ,EAAO,cAAc,KAAKI,CAAM,CAAA,CACjC,CAAA,CACF,CAAA,CAGK,WAAWC,EAAaC,EAA4B,CAC1D,GAAIL,EAAS,cAAc,eAAeI,CAAG,IAAI,EAAG,CAC1C,QAAA,IAAI,cAAcA,CAAG,kBAAkB,EACtCC,EAAA,EACT,MAAA,CAEI,MAAAC,EAASN,EAAS,cAAc,QAAQ,EAC9CM,EAAO,IAAMF,EACbE,EAAO,MAAQ,GACfA,EAAO,KAAO,kBACdA,EAAO,OAASD,EAChBC,EAAO,QAAU,IAAM,QAAQ,MAAM,8BAA8BF,CAAG,EAAE,EACxEJ,EAAS,KAAK,YAAYM,CAAM,CAAA,CAG1B,cAAcD,EAAsBE,EAAU,GAAIC,EAAW,IAAW,CAC1ET,EAAO,cACAM,EAAA,EACAE,EAAU,GACX,QAAA,IAAI,kDAAkDA,CAAO,EAAE,EAC5D,WAAA,IAAM,KAAK,cAAcF,EAAUE,EAAU,EAAGC,CAAQ,EAAGA,CAAQ,GAE9E,QAAQ,MAAM,yCAAyC,CACzD,CACF,CAGFT,EAAO,QAAU,SAAUU,EAAgBN,EAAuB,CAC5DM,IAAW,oBACT,IAAAR,EAAA,EAAU,WAAWE,CAAM,EAEvB,QAAA,MAAM,uBAAuBM,CAAM,EAAE,CAEjD,CACF,GAAG,OAAQ,QAAQ"}